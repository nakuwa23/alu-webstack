#!/usr/bin/env bash
# This script displays DNS record type and destination for a website subdomain

fetch_info() {
    local domain=$1
    local subdomain=$2

    local dig_line
    dig_line=$(dig "${subdomain}.${domain}" | grep -A1 'ANSWER SECTION:' | awk 'NR==2 {print $4, $5}')

    local record_type ip
    record_type=$(echo "$dig_line" | awk '{print $1}')
    ip=$(echo "$dig_line" | awk '{print $2}')

    echo "The subdomain $subdomain is a $record_type record and points to $ip"
}

domain=$1
subdomain=${2:-}

if [ -z "$subdomain" ]; then
    for s in www lb-01 web-01 web-02; do
        fetch_info "$domain" "$s"
    done
else
    fetch_info "$domain" "$subdomain"
fi

